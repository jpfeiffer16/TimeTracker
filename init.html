<html>
  <head>
    <script src="https://secure.aadcdn.microsoftonline-p.com/lib/1.0.12/js/adal.min.js"></script>
    <script>
      var ADAL = new AuthenticationContext({
          instance: 'https://login.microsoftonline.com/',
          tenant: 'common', //COMMON OR YOUR TENANT ID

          clientId: '5f168ad7-a1d1-4851-a9d8-830535f0b2d4', //This is your client ID
          redirectUri: 'http://localhost', //This is your redirect URI

          callback: userSignedIn,
          popUp: true
      });

      function signIn() {
          ADAL.login();
      }

      function userSignedIn(err, token) {
          console.log('userSignedIn called');
          if (!err) {
              console.log("token: " + token);
              showWelcomeMessage();
          }
          else {
              console.error("error: " + err);
          }
      }

      function showWelcomeMessage() {
          var user = ADAL.getCachedUser();
          var divWelcome = document.getElementById('WelcomeMessage');
          divWelcome.innerHTML = "Welcome " + user.profile.name;
      }

    </script> 
  </head>
  <body>
    <button id="SignIn" onclick="signIn()">Sign In</button>
    <h4 id="WelcomeMessage"></h4>
  </body>
</html>